# 农历闹钟功能指南

## 📅 功能概述

AdvancedClock 现在支持**农历闹钟**功能！您可以设置在每年的农历特定日期触发的闹钟，非常适合：

- 🎂 **农历生日提醒**（如农历八月十五）
- 🎉 **传统节日提醒**（如春节、端午、中秋等）
- 🙏 **纪念日提醒**（如农历祭祀日期）
- 🌙 **其他农历日期事件**

## ✨ 主要特性

### 1. 完整的农历支持
- ✅ 支持 1900-2100 年的农历日期转换
- ✅ 支持闰月设置（如闰四月、闰六月等）
- ✅ 自动计算农历日期对应的公历日期
- ✅ 每年自动更新到下一个农历日期

### 2. 智能日期转换
- 🔄 自动将农历日期转换为公历日期
- 📆 实时显示对应的公历日期
- 🌙 显示当前日期的农历信息
- ⚡ 自动处理闰月情况

### 3. 循环提醒
- 🔁 每年农历同一天自动触发
- 🎯 无需手动更新，永不过期
- 📅 自动适应公历日期变化

## 🎯 使用方法

### 创建农历闹钟

#### 步骤 1：打开闹钟编辑对话框
1. 点击主窗口的 **"添加闹钟"** 按钮
2. 或选择现有闹钟点击 **"编辑闹钟"**

#### 步骤 2：选择循环模式
在 **"循环模式"** 下拉框中选择 **"每年农历"**

![循环模式选择](images/lunar-repeat-mode.png)

#### 步骤 3：设置农历日期
选择 "每年农历" 后，会显示 **"🌙 农历日期设置"** 面板：

1. **选择农历月份**：从下拉框选择（正月、二月...腊月）
2. **选择农历日期**：从下拉框选择（初一、初二...三十）
3. **闰月选项**：如果是闰月，勾选 "闰月" 复选框

![农历日期设置](images/lunar-date-panel.png)

#### 步骤 4：设置时间
设置闹钟触发的具体时间（时、分、秒）

#### 步骤 5：其他设置
- 设置闹钟名称（如"妈妈生日"）
- 设置提醒消息
- 选择是否强提醒
- 配置声音等其他选项

#### 步骤 6：保存
点击 **"确定"** 按钮保存闹钟

## 📋 使用示例

### 示例 1：农历生日提醒

**场景**：妈妈的生日是农历八月十五（中秋节）

**设置步骤**：
1. 闹钟名称：`妈妈生日`
2. 循环模式：`每年农历`
3. 农历月份：`八月`
4. 农历日期：`十五`
5. 闰月：`不勾选`
6. 时间：`08:00:00`（早上8点提醒）
7. 消息：`今天是妈妈的生日！记得送祝福 🎂`

**效果**：
- 每年农历八月十五早上8点触发
- 2025年对应公历：10月6日
- 2026年对应公历：9月25日
- 自动适应每年的公历日期变化

### 示例 2：春节提醒

**场景**：春节（农历正月初一）前一天提醒准备

**设置步骤**：
1. 闹钟名称：`春节准备`
2. 循环模式：`每年农历`
3. 农历月份：`正月`
4. 农历日期：`初一`
5. 时间：`20:00:00`（前一天晚上8点）
6. 提前提醒：启用，提前24小时

**效果**：
- 每年农历正月初一前一天晚上8点提醒
- 自动计算对应的公历日期

### 示例 3：端午节提醒

**场景**：端午节（农历五月初五）

**设置步骤**：
1. 闹钟名称：`端午节`
2. 循环模式：`每年农历`
3. 农历月份：`五月`
4. 农历日期：`初五`
5. 时间：`09:00:00`
6. 消息：`端午节快乐！记得吃粽子 🎋`

### 示例 4：闰月生日

**场景**：某人生日是闰四月初十

**设置步骤**：
1. 闹钟名称：`特殊生日`
2. 循环模式：`每年农历`
3. 农历月份：`四月`
4. 农历日期：`初十`
5. 闰月：`勾选` ✓
6. 时间：`08:00:00`

**注意**：
- 闰月不是每年都有
- 如果某年没有闰四月，系统会自动跳过
- 只在有闰四月的年份触发

## 🌙 农历知识

### 农历月份名称
| 序号 | 名称 | 说明 |
|------|------|------|
| 1 | 正月 | 农历一月 |
| 2 | 二月 | 农历二月 |
| 3 | 三月 | 农历三月 |
| 4 | 四月 | 农历四月 |
| 5 | 五月 | 农历五月 |
| 6 | 六月 | 农历六月 |
| 7 | 七月 | 农历七月 |
| 8 | 八月 | 农历八月 |
| 9 | 九月 | 农历九月 |
| 10 | 十月 | 农历十月 |
| 11 | 冬月 | 农历十一月 |
| 12 | 腊月 | 农历十二月 |

### 农历日期名称
- **初一到初十**：初一、初二、初三...初十
- **十一到二十**：十一、十二、十三...二十
- **廿一到廿九**：廿一、廿二、廿三...廿九
- **三十**：三十（大月才有）

### 闰月说明
- 农历采用闰月来调整与公历的差异
- 闰月不是每年都有，大约每2-3年出现一次
- 闰月可能出现在任何月份（如闰四月、闰六月等）
- 闰月年份有13个月，共383-385天

### 常见传统节日对应的农历日期

| 节日 | 农历日期 | 说明 |
|------|---------|------|
| 春节 | 正月初一 | 农历新年 |
| 元宵节 | 正月十五 | 上元节 |
| 龙抬头 | 二月初二 | 春耕节 |
| 清明节 | 三月初三前后 | 扫墓节（公历4月4-6日） |
| 端午节 | 五月初五 | 龙舟节 |
| 七夕节 | 七月初七 | 情人节 |
| 中元节 | 七月十五 | 鬼节 |
| 中秋节 | 八月十五 | 团圆节 |
| 重阳节 | 九月初九 | 登高节 |
| 冬至 | 十一月中下旬 | 公历12月21-23日 |
| 腊八节 | 腊月初八 | 喝腊八粥 |
| 小年 | 腊月廿三/廿四 | 祭灶节 |
| 除夕 | 腊月廿九/三十 | 春节前夜 |

## 🔧 技术实现

### 农历计算算法
- 基于 1900-2100 年的农历数据表
- 精确计算农历与公历的转换
- 支持闰月的准确识别和处理

### 数据存储
农历闹钟的数据包括：
```json
{
  "IsLunarCalendar": true,
  "LunarMonth": 8,
  "LunarDay": 15,
  "IsLeapMonth": false,
  "RepeatMode": "LunarYearly",
  "AlarmTime": "2025-10-06T08:00:00"
}
```

### 触发逻辑
1. 系统每秒检查所有闹钟
2. 对于农历闹钟，自动计算下一个触发的公历日期
3. 当公历日期和时间匹配时触发闹钟
4. 触发后自动更新到下一年的农历日期

## 📊 界面说明

### 农历日期设置面板

```
🌙 农历日期设置
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
选择农历日期：

农历月份：[八月 ▼]  农历日期：[十五 ▼]  ☐ 闰月

当前公历日期对应的农历：2025年腊月廿一

选择的农历日期对应的公历：八月十五 → 2025年10月06日

  提示：农历闹钟会在每年的农历指定日期触发，公历日期会自动计算
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 主窗口显示

农历闹钟在主窗口的显示格式：
```
名称：妈妈生日
时间：八月十五 08:00:00 (公历:2025-10-06)
循环：每年农历
状态：✓ 启用
```

## ⚠️ 注意事项

### 1. 日期范围限制
- 支持的年份范围：1900-2100 年
- 超出范围的日期无法转换

### 2. 闰月处理
- 闰月不是每年都有
- 如果设置了闰月闹钟，只在有对应闰月的年份触发
- 建议：除非确实需要，否则不要勾选"闰月"

### 3. 日期有效性
- 农历小月只有29天，大月有30天
- 如果选择了不存在的日期（如小月的三十），可能无法触发

### 4. 时区问题
- 农历计算基于中国标准时间（UTC+8）
- 如果在其他时区使用，可能会有1天的偏差

### 5. 数据兼容性
- 旧版本的闹钟数据会自动兼容
- 升级后不会影响现有的公历闹钟

## 🐛 常见问题

### Q1: 为什么我的闰月闹钟没有触发？
**A**: 闰月不是每年都有。例如，闰四月可能要等2-3年才会出现一次。您可以：
- 检查今年是否有对应的闰月
- 考虑不勾选"闰月"选项，使用普通月份

### Q2: 农历日期转换不准确怎么办？
**A**: 我们的农历算法支持 1900-2100 年，精度很高。如果发现问题：
- 确认日期在支持范围内
- 检查是否正确选择了闰月选项
- 查看系统时间是否正确

### Q3: 可以设置农历每月的闹钟吗？
**A**: 目前只支持"每年农历"模式，即每年的农历同一天。如果需要每月提醒，建议：
- 使用公历的"每月"模式
- 或创建12个农历闹钟（每个月一个）

### Q4: 农历闹钟会自动更新吗？
**A**: 是的！农历闹钟会自动更新：
- 触发后自动计算下一年的公历日期
- 程序启动时自动检查并更新过期的农历闹钟
- 无需手动维护

### Q5: 如何查看某个农历日期对应的公历日期？
**A**: 在编辑闹钟时：
1. 选择"每年农历"模式
2. 选择农历月份和日期
3. 面板会自动显示对应的公历日期

## 🎨 使用技巧

### 技巧 1：批量创建节日提醒
为所有传统节日创建闹钟：
1. 春节（正月初一）
2. 元宵节（正月十五）
3. 端午节（五月初五）
4. 中秋节（八月十五）
5. 重阳节（九月初九）

### 技巧 2：家人生日管理
为每位家人创建农历生日闹钟：
- 设置提前1天提醒，方便准备礼物
- 使用强提醒模式，确保不会错过
- 自定义消息，添加温馨祝福

### 技巧 3：结合提前提醒
对于重要的农历日期：
- 启用"提前提醒"功能
- 设置提前几天开始提醒
- 每天重复提醒，确保不会忘记

### 技巧 4：声音个性化
为不同的农历闹钟设置不同的声音：
- 生日用欢快的音乐
- 节日用传统音乐
- 纪念日用庄重的音乐

## 📚 相关文档

- [主要功能说明](../README.md)
- [循环闹钟说明](DAILY_ALARM_IMPROVEMENT.md)
- [声音增强功能](SOUND_ENHANCEMENT_GUIDE.md)
- [触发动作系统](ALARM_ACTIONS_GUIDE.md)

## 🔄 更新日志

### v2.6.0 (2025-12-20)
- ✅ 新增农历闹钟功能
- ✅ 支持 1900-2100 年农历日期转换
- ✅ 支持闰月设置
- ✅ 自动计算农历对应的公历日期
- ✅ 每年自动更新农历闹钟

## 💡 反馈与建议

如果您在使用农历闹钟功能时遇到问题或有改进建议，欢迎：
- 提交 Issue 到 GitHub
- 发送邮件反馈
- 在讨论区留言

---

**享受智能的农历闹钟功能！** 🌙✨

**永远不会错过重要的农历日期！** 🎉🎂
