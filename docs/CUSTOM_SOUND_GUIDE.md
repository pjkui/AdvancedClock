# 自定义闹钟声音功能说明

## 📋 功能概述

AdvancedClock 现在支持为每个闹钟设置自定义的提醒声音！你可以使用自己喜欢的音乐、铃声或任何音频文件作为闹钟声音。

## ✨ 主要特性

### 1. 多格式支持
- ✅ **WAV** - 无损音质，兼容性最好（推荐）
- ✅ **MP3** - 压缩格式，文件较小
- ✅ **WMA** - Windows Media Audio
- ✅ **M4A** - MPEG-4 Audio

### 2. 灵活配置
- 每个闹钟可以设置不同的声音
- 支持系统默认声音（不选择文件时）
- 支持试听功能，预览声音效果

### 3. 智能播放
- 自动检测文件格式并选择最佳播放方式
- WAV 文件使用 `SoundPlayer`（更可靠）
- MP3 等格式使用 `MediaPlayer`（更灵活）

## 🎯 使用方法

### 方法1：在创建闹钟时设置

1. 点击"添加闹钟"按钮
2. 填写闹钟基本信息（名称、时间等）
3. 在"🔊 闹钟声音"区域：
   - 点击"浏览..."按钮
   - 选择你的音频文件
   - 点击"试听"按钮测试效果
4. 点击"确定"保存

### 方法2：编辑现有闹钟

1. 选择要编辑的闹钟
2. 点击"编辑闹钟"按钮
3. 在"🔊 闹钟声音"区域设置声音
4. 点击"确定"保存

### 方法3：使用系统默认声音

1. 在声音配置区域
2. 点击"清除（使用系统默认）"按钮
3. 或者直接不选择任何文件

## 📸 界面说明

### 声音配置区域

```
┌─────────────────────────────────────────┐
│ 🔊 闹钟声音                              │
├─────────────────────────────────────────┤
│ 选择闹钟提醒声音：                       │
│                                          │
│ ┌──────────────────┬────────┬────────┐  │
│ │ [文件路径显示]    │ 浏览... │ 试听  │  │
│ └──────────────────┴────────┴────────┘  │
│                                          │
│ 支持格式: WAV, MP3, WMA, M4A            │
│ （留空使用系统默认声音）                 │
│                                          │
│ [清除（使用系统默认）]                   │
└─────────────────────────────────────────┘
```

### 按钮功能

- **浏览...** - 打开文件选择对话框，选择音频文件
- **试听** - 播放当前选择的声音，测试效果
- **清除** - 清除自定义声音，恢复使用系统默认声音

## 🎵 推荐的声音来源

### 免费音效网站

1. **Freesound** - https://freesound.org/
   - 海量免费音效库
   - 需要注册账号
   - 支持搜索和分类

2. **Zapsplat** - https://www.zapsplat.com/
   - 高质量音效
   - 免费下载
   - 分类清晰

3. **Mixkit** - https://mixkit.co/free-sound-effects/alarm/
   - 专业音效
   - 无需注册
   - 直接下载

### 搜索关键词

在这些网站搜索时，可以使用以下关键词：

- `alarm clock` - 闹钟声
- `bell` - 铃声
- `chime` - 钟声
- `morning` - 早晨音效
- `gentle alarm` - 轻柔闹钟
- `loud alarm` - 响亮闹钟
- `birds chirping` - 鸟鸣声

## 🔧 技术实现

### 音频播放服务 (AudioService)

```csharp
// 播放自定义声音或系统默认声音
AudioService.Instance.PlayAlarmSound(customSoundPath, isStrongAlert);

// 播放提前提醒声音
AudioService.Instance.PlayAdvanceReminderSound(customSoundPath);

// 测试声音
bool success = AudioService.Instance.TestSound(filePath);

// 验证音频文件
bool isValid = AudioService.Instance.IsValidAudioFile(filePath);
```

### 数据存储

自定义声音路径保存在闹钟数据中：

```json
{
  "Id": "guid",
  "Name": "早安闹钟",
  "AlarmTime": "2025-12-20T08:00:00",
  "CustomSoundPath": "E:/Music/morning-birds.mp3",
  "IsEnabled": true,
  "Message": "早安！"
}
```

## 📝 使用场景

### 场景1：温柔的早晨闹钟

```
闹钟名称：早安提醒
时间：每天 07:00
声音：gentle-birds.mp3（轻柔的鸟鸣声）
提醒方式：弱提醒（任务栏通知）
```

### 场景2：重要会议提醒

```
闹钟名称：重要会议
时间：2025-12-20 14:00
声音：urgent-alarm.wav（紧急铃声）
提醒方式：强提醒（全屏遮罩）
```

### 场景3：音乐闹钟

```
闹钟名称：起床音乐
时间：每天 08:00
声音：favorite-song.mp3（你喜欢的歌曲）
提醒方式：弱提醒
```

### 场景4：工作休息提醒

```
闹钟名称：休息时间
时间：每天 10:00, 15:00
声音：soft-chime.wav（轻柔的钟声）
提醒方式：弱提醒
```

## 🎨 创建自己的闹钟声音

### 使用 Audacity（免费开源）

1. **下载安装**
   - 访问：https://www.audacityteam.org/
   - 下载并安装 Audacity

2. **录制或导入音频**
   - 文件 -> 打开（导入现有音频）
   - 或使用麦克风录制

3. **编辑音频**
   - 剪切不需要的部分
   - 添加淡入淡出效果
   - 调整音量

4. **导出**
   - 文件 -> 导出 -> 导出为 WAV
   - 或导出为 MP3（需要安装 LAME 编码器）

### 简单的音调闹钟

```
1. 打开 Audacity
2. 生成 -> 音调
   - 波形：正弦波
   - 频率：440Hz（标准A音）
   - 振幅：0.8
   - 时长：10秒
3. 效果 -> 淡入淡出
4. 文件 -> 导出 -> 导出为 WAV
```

## ⚙️ 高级设置

### 音频文件优化

**推荐参数**：
- **采样率**: 44.1kHz 或 48kHz
- **比特率**: 128kbps 以上（MP3）
- **声道**: 单声道或立体声
- **时长**: 10-30秒（闹钟声音）
- **文件大小**: 不超过 10MB

### 音量调整

如果声音太小或太大：

1. **使用音频编辑软件调整**
   - Audacity: 效果 -> 放大/衰减
   - 调整到合适的音量

2. **使用 Windows 音量混合器**
   - 右键任务栏音量图标
   - 打开音量混合器
   - 调整 AdvancedClock 的音量

## 🐛 故障排除

### 问题1：声音无法播放

**可能原因**：
- 文件格式不支持
- 文件路径错误
- 文件已被删除或移动

**解决方法**：
1. 检查文件格式是否为 WAV, MP3, WMA, M4A
2. 重新选择文件
3. 尝试使用系统默认声音

### 问题2：声音播放不完整

**可能原因**：
- MP3 文件编码问题
- 文件损坏

**解决方法**：
1. 转换为 WAV 格式
2. 使用其他音频文件
3. 重新下载或录制音频

### 问题3：找不到浏览按钮

**解决方法**：
1. 确保使用最新版本的 AdvancedClock
2. 在闹钟编辑对话框中向下滚动
3. 查找"🔊 闹钟声音"区域

### 问题4：试听按钮无反应

**可能原因**：
- 音频设备问题
- 文件路径错误

**解决方法**：
1. 检查系统音量是否静音
2. 检查音频设备是否正常
3. 重新选择文件

## 📊 性能说明

### 内存占用

- WAV 文件播放：约 1-5MB 内存
- MP3 文件播放：约 2-10MB 内存
- 系统默认声音：几乎不占用额外内存

### 播放延迟

- WAV 文件：几乎无延迟（< 100ms）
- MP3 文件：轻微延迟（< 500ms）
- 系统默认声音：无延迟

## 🔗 相关文档

- [声音资源文件夹说明](../sounds/README.md)
- [项目主文档](../README.md)
- [闹钟功能测试指南](TESTING_GUIDE.md)

## 📅 更新日志

### v2.4 (2025-12-19) 🆕
- ✅ 新增自定义闹钟声音功能
- ✅ 支持 WAV, MP3, WMA, M4A 格式
- ✅ 添加声音试听功能
- ✅ 创建 AudioService 音频播放服务
- ✅ 更新闹钟编辑对话框UI

## 💡 使用技巧

1. **不同场景使用不同声音**
   - 早晨：轻柔的音乐或鸟鸣
   - 工作：简短的提示音
   - 重要事项：响亮的警报声

2. **声音文件管理**
   - 在 `sounds/` 文件夹中按类别组织
   - 使用有意义的文件名
   - 定期清理不用的文件

3. **测试声音效果**
   - 创建闹钟后先试听
   - 调整音量到合适的大小
   - 确保声音不会太吵或太轻

4. **备份声音文件**
   - 将常用的声音文件备份
   - 避免误删重要文件

---

**享受个性化的闹钟体验！** 🎵⏰
