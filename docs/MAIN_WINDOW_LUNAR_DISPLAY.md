# 主界面农历显示功能

## 📅 功能概述

主界面现在实时显示当前的农历日期，让您随时了解农历信息。

## ✨ 功能特性

### 1. 实时农历显示
- 🌙 在主界面顶部显示当前农历日期
- 🔄 每秒自动更新
- 📆 完整显示农历年月日信息

### 2. 显示格式
```
🌙 农历：2025年腊月廿一
```

显示内容包括：
- 农历年份（如：2025年）
- 农历月份（如：正月、二月...腊月）
- 农历日期（如：初一、初二...三十）
- 闰月标识（如果是闰月，会显示"闰"字）

### 3. 界面布局

```
┌─────────────────────────────────────────────┐
│          高级定时闹钟                        │
├─────────────────────────────────────────────┤
│                                              │
│  当前时间：2025-12-20 10:47:42.123 星期五   │
│  🌙 农历：2025年腊月廿一                     │
│  时钟精度：高精度模式 (±1ms)                │
│                                              │
├─────────────────────────────────────────────┤
│                                              │
│            [闹钟列表区域]                    │
│                                              │
└─────────────────────────────────────────────┘
```

## 🎨 视觉设计

### 颜色方案
- **农历图标**：🌙 橙色 (#FF9800)
- **农历文字**：深橙色 (#FF6F00)，加粗显示
- **背景**：浅灰色 (#F0F0F0)

### 字体大小
- 公历时间：16px
- 农历日期：14px
- 时钟精度：11px

## 🔧 技术实现

### 1. XAML 布局
在 `MainWindow.xaml` 中添加了农历显示控件：

```xml
<!-- 农历日期 -->
<StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,5,0,0">
    <TextBlock Text="🌙 农历：" FontSize="14" VerticalAlignment="Center" Foreground="#FF9800"/>
    <TextBlock x:Name="LunarDateText" FontSize="14" FontWeight="Bold" 
               VerticalAlignment="Center" Foreground="#FF6F00"/>
</StackPanel>
```

### 2. 代码逻辑
在 `MainWindow.xaml.cs` 中添加了更新方法：

```csharp
/// <summary>
/// 更新农历日期显示
/// </summary>
private void UpdateLunarDate(DateTime currentTime)
{
    try
    {
        var lunarDate = LunarCalendarService.SolarToLunar(currentTime);
        LunarDateText.Text = lunarDate.DisplayText;
    }
    catch (Exception ex)
    {
        LunarDateText.Text = "农历日期获取失败";
        System.Diagnostics.Debug.WriteLine($"获取农历日期失败: {ex.Message}");
    }
}
```

### 3. 更新机制
- 使用现有的 `_clockTimer` 定时器（每秒触发一次）
- 在 `UpdateCurrentTime()` 方法中调用 `UpdateLunarDate()`
- 与公历时间同步更新

## 📊 性能影响

### 计算开销
- 农历转换算法高效，单次计算耗时 < 1ms
- 每秒更新一次，对性能影响可忽略不计
- 不会影响闹钟的精确触发

### 内存占用
- 农历数据表已预加载在内存中
- 每次更新只创建一个 `LunarDate` 对象
- 内存占用增加 < 1KB

## 🌙 农历知识

### 显示示例

| 公历日期 | 农历显示 |
|---------|---------|
| 2025-01-29 | 2024年腊月三十 |
| 2025-01-30 | 2025年正月初一（春节） |
| 2025-02-12 | 2025年正月十五（元宵节） |
| 2025-05-31 | 2025年五月初五（端午节） |
| 2025-10-06 | 2025年八月十五（中秋节） |

### 特殊日期
- **春节**：正月初一
- **元宵节**：正月十五
- **端午节**：五月初五
- **中秋节**：八月十五
- **重阳节**：九月初九

### 闰月显示
如果当前日期是闰月，会显示"闰"字：
```
🌙 农历：2025年闰四月初十
```

## 💡 使用场景

### 1. 日常查看
- 快速了解当前农历日期
- 无需打开日历应用
- 随时掌握农历信息

### 2. 节日提醒
- 一眼看出是否临近传统节日
- 方便安排节日活动
- 提前准备节日礼物

### 3. 农历生日
- 查看自己或家人的农历生日
- 配合农历闹钟功能使用
- 永不错过重要日子

### 4. 传统习俗
- 查看农历日期进行祭祀
- 选择良辰吉日
- 遵循传统习俗

## 🔄 与农历闹钟的配合

主界面的农历显示与农历闹钟功能完美配合：

1. **实时对照**
   - 查看当前农历日期
   - 对比闹钟设置的农历日期
   - 了解距离闹钟触发的时间

2. **设置参考**
   - 创建农历闹钟时参考当前农历
   - 快速确认农历日期
   - 避免设置错误

3. **一致性**
   - 使用相同的农历计算服务
   - 显示格式统一
   - 数据准确可靠

## ⚠️ 注意事项

### 1. 日期范围
- 支持 1900-2100 年的农历日期
- 超出范围会显示"农历日期获取失败"

### 2. 时区
- 基于系统本地时间计算
- 农历计算基于中国标准时间（UTC+8）

### 3. 更新频率
- 每秒更新一次
- 在午夜时分会自动切换到新的农历日期

## 🎉 优势特点

### 1. 方便快捷
- ✅ 无需额外操作
- ✅ 自动实时更新
- ✅ 一目了然

### 2. 美观大方
- ✅ 清晰的视觉设计
- ✅ 醒目的颜色搭配
- ✅ 合理的布局安排

### 3. 准确可靠
- ✅ 使用专业的农历算法
- ✅ 支持闰月识别
- ✅ 数据精确无误

### 4. 性能优秀
- ✅ 计算速度快
- ✅ 内存占用少
- ✅ 不影响其他功能

## 📚 相关文档

- [农历闹钟功能指南](LUNAR_ALARM_GUIDE.md) - 农历闹钟详细说明
- [农历功能实现](LUNAR_ALARM_IMPLEMENTATION.md) - 技术实现细节
- [主要功能说明](../README.md) - 完整功能列表

## 🔄 更新日志

### v2.6.1 (2025-12-20)
- ✅ 新增主界面农历日期实时显示
- ✅ 优化界面布局，增加农历显示区域
- ✅ 使用醒目的颜色和图标
- ✅ 与农历闹钟功能完美配合

---

**享受便捷的农历日期查看功能！** 🌙✨

**随时掌握农历信息，永不错过重要日子！** 📅🎉
