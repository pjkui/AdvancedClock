# 测试倒计时功能

## 测试步骤

### 1. 启动程序
运行 `AdvancedClock.exe`

### 2. 观察默认闹钟的倒计时
程序会自动创建几个示例闹钟，观察它们的倒计时列：
- 查看不同时间范围的倒计时格式
- 观察颜色变化（绿色 → 琥珀色 → 橙色 → 深橙色 → 红色）

### 3. 创建测试闹钟

#### 测试 1：即将触发的闹钟（1分钟后）
1. 点击"添加闹钟"按钮
2. 设置名称：`测试1分钟`
3. 设置时间：当前时间 + 1分钟
4. 点击"确定"
5. 观察倒计时从 `01:00` 开始倒数
6. 颜色应该是橙色（临近状态）
7. 最后30秒应该变为深橙色

#### 测试 2：30秒后触发的闹钟
1. 点击"添加闹钟"
2. 设置名称：`测试30秒`
3. 设置时间：当前时间 + 30秒
4. 观察倒计时显示为 `30秒`、`29秒`...
5. 颜色应该是深橙色（即将触发）

#### 测试 3：长时间闹钟
1. 点击"添加闹钟"
2. 设置名称：`测试2小时`
3. 设置时间：当前时间 + 2小时
4. 倒计时应显示为 `02:00:00` 格式
5. 颜色应该是绿色（正常状态）

#### 测试 4：跨天闹钟
1. 点击"添加闹钟"
2. 设置名称：`测试明天`
3. 设置时间：明天的某个时间
4. 倒计时应显示为 `1天 XX:XX:XX` 格式
5. 颜色应该是绿色

### 4. 测试状态变化

#### 测试禁用状态
1. 取消某个闹钟的"启用"复选框
2. 倒计时应显示为 `-`（灰色）

#### 测试过期状态
1. 创建一个过去时间的闹钟（通过手动编辑数据文件或等待闹钟触发）
2. 倒计时应显示为 `已过期` 或 `需更新`（红色）

### 5. 测试颜色渐变
观察一个即将触发的闹钟的颜色变化：
- 30分钟前：绿色
- 29分钟时：变为琥珀色
- 4分钟时：变为橙色
- 59秒时：变为深橙色
- 触发后：变为红色（已过期）

### 6. 测试实时更新
1. 观察倒计时数字每秒自动更新
2. 确认没有明显的界面闪烁
3. 确认数字对齐（使用等宽字体）

### 7. 测试循环闹钟
1. 创建一个每天循环的闹钟，设置为1分钟后
2. 等待闹钟触发
3. 观察倒计时是否自动更新到下一次时间（24小时后）

## 预期结果

✅ 倒计时每秒更新
✅ 格式根据时间范围自动切换
✅ 颜色根据剩余时间动态变化
✅ 禁用的闹钟显示灰色 `-`
✅ 过期的闹钟显示红色"已过期"
✅ 界面无闪烁，数字对齐美观
✅ 触发后循环闹钟自动更新倒计时

## 问题排查

### 问题1：倒计时不更新
**可能原因**：时钟定时器未启动
**解决方案**：检查 `ClockTimer_Tick` 方法是否调用 `UpdateAllCountdowns()`

### 问题2：颜色不变化
**可能原因**：颜色转换器未注册
**解决方案**：确认 `StringToColorConverter` 已在 Window.Resources 中注册

### 问题3：倒计时显示为空
**可能原因**：数据绑定错误
**解决方案**：检查 XAML 中 `CountdownText` 和 `CountdownColor` 的绑定

### 问题4：数字不对齐
**可能原因**：字体设置错误
**解决方案**：确认使用 `Consolas` 等宽字体

## 性能检查

在任务管理器中查看：
- CPU 使用率应该很低（< 1%）
- 内存使用稳定，无内存泄漏
- 界面响应流畅，无卡顿
