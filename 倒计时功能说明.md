# 倒计时功能说明

## 新增功能

在主界面的闹钟列表中新增了一个**实时倒计时列**，用于显示距离每个闹钟触发时间的剩余时间。

## 功能特点

### 1. 实时更新
- 倒计时每秒自动更新
- 精确到秒级显示
- 与当前时间完全同步

### 2. 智能显示格式
倒计时根据剩余时间自动调整显示格式：

- **小于 1 分钟**：显示秒数，如 `45秒`
- **1 分钟 ~ 1 小时**：显示 `分:秒`，如 `05:30`
- **1 小时 ~ 1 天**：显示 `时:分:秒`，如 `02:15:30`
- **超过 1 天**：显示 `X天 时:分:秒`，如 `3天 12:30:45`

### 3. 动态颜色提示
倒计时使用不同颜色提供视觉警示：

| 状态 | 颜色 | 说明 |
|------|------|------|
| 正常 | 🟢 绿色 | 距离触发时间超过 30 分钟 |
| 较近 | 🟡 琥珀色 | 距离触发时间 5-30 分钟 |
| 临近 | 🟠 橙色 | 距离触发时间 1-5 分钟 |
| 即将触发 | 🔴 深橙色 | 距离触发时间不足 1 分钟 |
| 已过期 | 🔴 红色 | 闹钟时间已过，显示"已过期"或"需更新" |
| 已禁用 | ⚪ 灰色 | 闹钟未启用，显示"-" |

### 4. 特殊状态处理

- **禁用的闹钟**：显示 `-`（灰色）
- **已过期的一次性闹钟**：显示 `已过期`（红色）
- **需要更新的循环闹钟**：显示 `需更新`（红色）

## 界面布局

倒计时列位于闹钟列表中的以下位置：
```
启用 | 名称 | 闹钟时间 | [倒计时] | 循环模式 | ...
```

列宽：120 像素，使用 Consolas 等宽字体，加粗显示，确保数字对齐美观。

## 使用示例

### 示例 1：即将触发的闹钟
```
名称：工作提醒
闹钟时间：2025-12-10 14:30:00
倒计时：00:00:45  🔴 (深橙色，即将触发)
```

### 示例 2：正常状态的闹钟
```
名称：会议提醒
闹钟时间：2025-12-10 15:00:00
倒计时：01:15:30  🟢 (绿色，正常)
```

### 示例 3：跨天的闹钟
```
名称：生日提醒
闹钟时间：2025-12-15 09:00:00
倒计时：4天 18:30:00  🟢 (绿色，正常)
```

### 示例 4：已过期的闹钟
```
名称：过期闹钟
闹钟时间：2025-12-10 10:00:00
倒计时：已过期  🔴 (红色)
```

## 技术实现

### 1. 数据绑定
倒计时通过 WPF 的数据绑定机制实现：
- `CountdownText` 属性：提供倒计时文本
- `CountdownColor` 属性：提供动态颜色
- `UpdateCountdown()` 方法：每秒刷新数据

### 2. 自动更新机制
主窗口的时钟定时器每秒触发一次，自动更新所有闹钟的倒计时显示。

### 3. 颜色转换
使用 `StringToColorConverter` 将十六进制颜色字符串转换为 WPF 画刷。

## 性能优化

- 采用 INotifyPropertyChanged 机制，只更新变化的数据
- 使用等宽字体确保数字对齐，避免闪烁
- 颜色计算优化，避免频繁的对象创建

## 未来改进方向

- [ ] 添加倒计时完成时的动画效果
- [ ] 支持自定义倒计时颜色方案
- [ ] 添加倒计时到达某个阈值时的声音提示
- [ ] 支持在系统托盘显示最近的倒计时
